<div layout="row" layout-margin layout="column" data-ng-controller="CreateCtrl" ng-cloak class="create">
    <div flex>
        <md-card>
            <md-toolbar>
                <div class="md-toolbar-tools">
                    <h2>Create a non-profit campaign</h2>
                </div>
            </md-toolbar>
            <md-stepper-card-content class="md-no-padding">
                <md-steppers md-dynamic-height md-stretch-steppers="always" md-selected="vm.selectedStep" md-busy-text="'Fetching data & other things...'" md-busy="vm.showBusyText">
                    <md-step label="Enter Url" md-complete="vm.stepData[0].completed" ng-disabled="vm.stepProgress < 1">
                        <md-step-body>
                            <div layout="column">
                                <div layout="row" layout-padding layout-align="center start">
                                    <div flex="60" flex-sm="90" flex-xs="100">
                                        <span class="md-title">
                                            Paste any non-profit url
                                        </span>
                                        <form name="step1" ng-submit="getUrlInfo(vm.stepData[0].data.product_url)">
                                            <div layout="row" layout-xs="column" flex>
                                                <md-input-container flex class="md-block">
                                                    <input name="product_url" ng-model="vm.stepData[0].data.product_url" ng-disabled="vm.showBusyText" md-select-on-focus ng-pattern="urlPattern" ng-model-options="{ updateOn: 'default blur', debounce: { default: 300, blur: 300 } }" required />
                                                    <div class="hint" ng-show="showProductUrlHint">Example: {{productUrlHint}}</div>
                                                    <div ng-messages="step1.product_url.$error" role="alert">
                                                        <div ng-message-exp="['required','pattern']">
                                                            That doesn't look like a valid url... are you sure you pasted the right thing?
                                                        </div>
                                                    </div>
                                                </md-input-container>
                                                <div>
                                                    <md-button type="submit" class="md-raised" ng-disabled="!vm.stepData[0].data.product_url || loading_embedly || vm.showBusyText" aria-label="Get URL Info"  ng-click="getUrlInfo(vm.stepData[0].data.product_url)">
                                                        <md-icon class="material-icons">search</md-icon>
                                                        Find Cause
                                                    </md-button>
                                                </div>
                                            </div>
                                        </form>
                                        <md-progress-linear md-mode="indeterminate" ng-show="loading_embedly"></md-progress-linear>
                                        <div ng-show="showPreview">
                                            <embedly urlsearch="{{urlSearch}}"></embedly>
                                            <md-toolbar class="md-accent">
                                                <div class="md-toolbar-tools">
                                                    <md-icon class="material-icons" hide-xs style="margin-right:10px">arrow_upward</md-icon>
                                                    <h2>Does this look right?</h2>
                                                    <span flex></span>
                                                    <md-button hide-xs class="md-accent md-hue-3 md-mini" ng-disabled="vm.showBusyText || loading_embedly || !showPreview" ng-click="showUrlEducationDialog($event)" aria-label="No, but why?">
                                                        No
                                                    </md-button>
                                                    <md-button class="md-primary md-raised" ng-disabled="vm.showBusyText || loading_embedly || !showPreview" ng-click="vm.submitCurrentStep(vm.stepData[0])" aria-label="Yep, let's move on!">
                                                        Yes<span hide-xs>, let's move on!</span>
                                                    </md-button>
                                                </div>
                                            </md-toolbar>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </md-step-body>
                    </md-step>
                    <md-step label="Customize" md-complete="vm.stepData[1].completed" ng-disabled="vm.stepProgress < 2">
                        <md-step-body>
                            <div layout="column" layout-gt-sm="row" layout-align="center start">
                                <div flex="100" flex-gt-sm="50" flex-order="1" flex-order-gt-sm="0" layout-padding>
                                    <embedly urlsearch="{{urlSearch}}" onempty="tryAgain()"></embedly>
                                    <md-toolbar class="md-accent">
                                        <div class="md-toolbar-tools">
                                            <md-icon class="material-icons" hide-xs style="margin-right:10px">arrow_upward</md-icon>
                                            <h2>Is this correct?</h2>
                                            <span flex></span>
                                            <md-button hide-xs class="md-accent md-hue-3 md-mini" ng-disabled="vm.showBusyText" ng-click="vm.moveToPreviousStep()" aria-label="Go back">
                                                No, go back
                                            </md-button>
                                            <md-button class="md-primary md-raised" ng-disabled="vm.showBusyText" ng-click="vm.submitCurrentStep(vm.stepData[1])" aria-label="Yep, let's move on!">
                                                Yes<span hide-xs>, create campaign link!</span>
                                            </md-button>
                                        </div>
                                    </md-toolbar>
                                </div>
                                <div flex="100" flex-gt-sm="50" flex-order="0" flex-order-gt-sm="1" layout-padding layout-margin>
                                    <span class="md-title">Customize your cause. (optional)</span>
                                    <form name="step2">
                                        <md-input-container class="md-block">
                                            <label>Title of cause</label>
                                            <!-- bind embedly title here -->
                                            <input name="title" ng-model="vm.stepData[1].data.title" required/>
                                            <div ng-messages="step2.title.$error" role="alert">
                                                <div ng-message-exp="['required']">
                                                    Please add a title to your cause so we know what to call it.
                                                </div>
                                            </div>
                                        </md-input-container>
                                        <md-input-container class="md-block">
                                            <label>Total Donation Amount</label>
                                            <!-- bind embedly price here, if it exists -->
                                            <input name="price" ng-model="vm.stepData[1].data.price" value="vm.stepData[1].data.price | number:2" required />
                                            <div class="hint">Taxes will be added to physical products during campaign creation. Shipping is free.</div>
                                            <div ng-messages="step2.price.$error" role="alert">
                                                <div ng-message-exp="['required']">
                                                    Please add a donation price for your cause so we know how much to help you raise.
                                                </div>
                                            </div>
                                        </md-input-container>
                                        <p>Choose campaign image</p>
                                        <md-content layout="row" layout-xs="column" layout-align="start start" layout-wrap>
                                                <md-card flex="20">
                                                    <a href="javascript:;" style="border: 1px solid blue">
                                                        <img src="http://www.bloodworksnw.org/images/home/fuel-level-header.jpg" class="md-card-image" alt="" />
                                                    </a>
                                                </md-card>
                                                <md-card flex="20">
                                                    <a href="javascript:;">
                                                        <img src="http://www.bloodworksnw.org/images/home/donate_blood.jpg" class="md-card-image" alt="">
                                                    </a>
                                                </md-card>
                                                <md-card flex="20">
                                                    <a href="javascript:;">
                                                        <img src="http://www.bloodworksnw.org/images/home/be_a_volunteer.jpg" class="md-card-image" alt="">
                                                    </a>
                                                </md-card>
                                                <md-card flex="20">
                                                    <a href="javascript:;">
                                                        <img src="http://www.bloodworksnw.org/images/home/donate_funds.jpg" class="md-card-image" alt="">
                                                    </a>
                                                </md-card>
                                                <md-card flex="20">
                                                    <a href="javascript:;">
                                                        <img src="http://www.bloodworksnw.org/images/home/iam_bloodworks.jpg" class="md-card-image" alt="">
                                                    </a>
                                                </md-card>
                                        </md-content>
                                        <md-content layout-padding>
                                            <md-checkbox>Upload custom image</md-checkbox>
                                            <script type="text/javascript" src="//api.filestackapi.com/filestack.js"></script>
                                            <input type="filepicker" data-fp-apikey="AVdh2bvkuTYKQI3rdMsZXz"
                                            onchange="alert(event.fpfile.url)">
                                        </md-content>
                                    </form>
                                </div>
                            </div>
                        </md-step-body>
                    </md-step>
                    <md-step label="Finish" md-complete="vm.stepData[2].completed" ng-disabled="vm.stepProgress < 3">
                        <md-step-body>
                            <div layout="row" layout-padding layout-align="center start">
                                <div flex="50" flex-sm="90" flex-xs="100">
                                    <span class="md-title">Copy/paste the link below into a new tab</span>
                                    <div layout="row" layout-xs="column" flex>
                                        <md-input-container flex class="md-block">
                                            <input name="short_link" ng-model="campaignCreateShortLink" md-select-on-focus ng-readonly="true" />
                                        </md-input-container>
                                        <div>
                                            <md-button type="submit" class="md-raised" aria-label="Copy URL">
                                                <md-icon class="material-icons">search</md-icon>
                                                Copy Url
                                            </md-button>
                                        </div>
                                    </div>
                                    <md-toolbar class="md-accent md-hue-2">
                                        <div class="md-toolbar-tools">
                                            <md-icon class="material-icons" hide-xs style="margin-right:10px">trending_flat</md-icon>
                                            <h2 hide-xs hide-sm>Want to create this campaign now?</h2>
                                            <h2 hide-md hide-lg hide-xl>Create campaign now?</h2>
                                            <span flex></span>
                                            <md-button class="md-primary md-raised md-hue-2" ng-disabled="vm.showBusyText" ng-click="vm.submitCurrentStep(vm.stepData[1])" aria-label="Yep, let's move on!">
                                                Yes<span hide-xs>, create now!</span>
                                            </md-button>
                                        </div>
                                    </md-toolbar>
                                </div>
                            </div>
                            <md-step-actions layout="row" layout-padding>
                                <div flex layout="row" layout-align="start top">
                                    <md-button ng-click="vm.moveToPreviousStep()">Go Back</md-button>
                                </div>
                                <div flex layout="row" layout-align="end top">
                                    <md-button class="md-warn" ng-click="vm.clearStepper()">
                                        Start Over
                                        <md-tooltip md-direction="left">
                                            Starting over will lose current progress.
                                        </md-tooltip>
                                    </md-button>
                                </div>
                            </md-step-actions>
                        </md-step-body>
                    </md-step>
                </md-steppers>
            </md-stepper-card-content>
        </md-card>
    </div>
</div>