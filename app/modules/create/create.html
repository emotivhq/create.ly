<style>
    .create .hint {
  /* Position the hint */
  position: absolute;
  left: 2px;
  right: auto;
  bottom: 7px;
  /* Copy styles from ng-messages */
  font-size: 12px;
  line-height: 14px;
  transition: all 0.3s cubic-bezier(0.55, 0, 0.55, 0.2);
  /* Set our own color */
  color: grey;
}

.create .hint.ng-hide,
.create .hint.ng-enter,
.create .hint.ng-leave.ng-leave-active {
  bottom: 26px;
  opacity: 0;
}

.create .hint.ng-leave,
.create .hint.ng-enter.ng-enter-active {
  bottom: 7px;
  opacity: 1;
}
</style>

<div layout="row" layout-margin layout="column" data-ng-controller="CreateCtrl" ng-cloak class="create">
    <div flex>
        <md-card>
            <md-card-title>
                <md-card-title-text>
                    <span class="md-headline">Enter any product URL</span>
                </md-card-title-text>
            </md-card-title>
            <md-card-content>
                <div>
                    <form name="productForm">
                        <md-input-container class="md-block">
                            <!--<label>Enter <em>any</em> product URL:</label>-->
                            <input name="product_url" ng-model="input_product_url" required ng-pattern="/^.+@.+\..+$/"></input>
                            
                            <div class="hint" ng-show="showHints">example: http://www.patagonia.com/us/product/womens-nano-puff-jacket?p=84216-0</div>
                            <div ng-messages="productForm.product_url.$error" ng-show="!showHints">
                                <div ng-message-exp="['required', 'pattern']">
                                    That doesn't look like an product url... Are ou sure you entered the right thing?
                                </div>
                            </div>
                        </md-input-container>
                        <md-button class="md-raised md-primary" ng-click="showProductPreview()">Preview Product</md-button>
                    </form>
                </div>
            </md-card-content>
        </md-card>
    </div>
    <div flex ng-show="show_product_preview">
        <h2>Preview Campaign</h2>
        <p>Below is the information we were able to grab from the url you provided.</p>
        <div>
            <em-embed urlsearch="{{product_url}}" maxwidth="100%" onempty="tryAgain()"></em-embed>
            <!-- https://github.com/Urigo/angular-embedly -->
        </div>
        <md-button class="md-raised md-primary" ng-click="hideProductPreview()">Close Preview</md-button>
    </div>
</div>
<div layout="row" layout-margin layout="column" data-ng-controller="CreateCtrl" ng-cloak>
    <div flex>
        <md-card>
            <md-toolbar>
                <div class="md-toolbar-tools">
                    <h2>
                        <md-icon md-svg-icon="md-menu"></md-icon>
                        <span>Create custom campaign</span>
                    </h2>
                </div>
            </md-toolbar>
            <md-stepper-card-content class="md-no-padding">
                <md-steppers md-dynamic-height md-stretch-steppers="always" md-selected="vm.selectedStep" md-busy-text="'Fetching data & other things...'" md-busy="vm.showBusyText">
                    <md-step label="Enter Url" md-complete="vm.stepData[0].data.completed" ng-disabled="vm.stepProgress < 1">
                        <md-step-body>
                            <form name="step1" ng-submit="vm.submitCurrentStep(vm.stepData[0].data)">
                                <md-content class="md-padding">
                                    <div layout="row" layout-align="center top">
                                        <div flex="nogrow" style="width: 400px">
                                            <span class="md-subhead">Creating a custom GiftStarter campaign has never been so easy. Simply copy/paste any link into the input below.</span>
                                            <md-input-container class="md-block">
                                                <label>Paste a valid URL</label>
                                                <input name="product_url" ng-model="vm.stepData[0].data.product_url" ng-model="product_url" ng-pattern="/^.+@.+\..+$/" ng-disabled="vm.stepData[0].data.completed" required></input>
                                                <div ng-messages="step1.product_url.$error">
                                                    <div ng-message="required">
                                                        A valid URL is required
                                                    </div>
                                                </div>
                                            </md-input-container>
                                        </div>
                                    </div>
                                </md-content>
                                <md-step-actions layout="row">
                                    <div flex layout="row" layout-align="end top">
                                        <md-button class="md-warn">Cancel</md-button>
                                        <md-button type="submit" ng-disabled="!vm.stepData[0].data.product_url || vm.showBusyText" class="md-primary md-raised">Next</md-button>
                                    </div>
                                </md-step-actions>
                            </form>
                        </md-step-body>
                    </md-step>
                    <md-step label="Review details" md-complete="vm.stepData[1].data.completed" ng-disabled="vm.stepProgress < 2">
                        <md-step-body>
                            <em-embed urlsearch="{{input_product_url}}" maxwidth="100%" onempty="tryAgain()"></em-embed>
                        </md-step-body>
                    </md-step>
                    <md-step label="Customize" md-complete="vm.stepData[2].data.completed" ng-disabled="vm.stepProgress < 3">
                        <md-step-body>
                            <form name="step2">
                                <md-content class="md-padding">
                                    <div layout="row" layout-align="center top">
                                        <div flex="nogrow" style="width: 400px">
                                            <h4>Please enter yout full name</h4>
                                            <md-input-container class="md-block">
                                                <label>Your first name here</label>
                                                <input name="firsname" ng-model="vm.stepData[1].data.firsname"/>
                                            </md-input-container>
                                            <md-input-container class="md-block">
                                                <label>Your last name</label>
                                                <input name="lastname" ng-model="vm.stepData[1].data.lastname"/>
                                            </md-input-container>
                                        </div>
                                    </div>
                                </md-content>
                                <md-step-actions layout="row">
                                    <div flex>
                                        <md-button ng-click="vm.moveToPreviousStep()">PREVIOUS</md-button>
                                    </div>
                                    <div flex layout="row" layout-align="end top">
                                        <md-button class="md-warn">CANCEL</md-button>
                                        <md-button ng-disabled="vm.showBusyText" ng-click="vm.submitCurrentStep(vm.stepData[1].data, !(vm.stepData[1].data.firsname && vm.stepData[1].data.lastname))" class="md-primary md-raised">
                                            {{ vm.stepData[1].data.firsname && vm.stepData[1].data.lastname ? 'NEXT' : 'SKIP' }}
                                        </md-button>
                                    </div>
                                </md-step-actions>
                            </form>
                        </md-step-body>
                    </md-step>
                            
                    <md-step label="Finish" md-complete="vm.stepData[3].data.completed" ng-disabled="vm.stepProgress < 4">
                        <md-step-body>
                            <form name="step3">
                                <md-content class="md-padding">
                                    <div layout="column" layout-align="center center" style="min-height: 200px">
                                        <h4>Yasss! your custom campaign link was created.</h4>
                                        <md-button class="md-primary md-raised">Create a campaign</md-button>
                                    </div>
                                </md-content>
                            </form>
                        </md-step-body>
                    </md-step>
                </md-steppers>
            </md-stepper-card-content>
        </md-card>
    </div>
</div>